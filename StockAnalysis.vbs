Sub stockAnalysis()For Each ws In ThisWorkbook.Sheets        ws.Activate        Dim ticker As String        Dim openPrice As Double        Dim closePrice As Double        Dim yearlyChange As Double        Dim percentChange As Double        Dim totalVolume As Double        Dim summaryRow As Long        Dim maxPercentIncrease As Double        Dim maxPercentDecrease As Double        Dim maxTotalVolume As Double        Dim maxPercentIncreaseTicker As String        Dim maxPercentDecreaseTicker As String        Dim maxTotalVolumeTicker As String                Dim lastRow As Long        lastRow = Cells(Rows.Count, "A").End(xlUp).Row                For i = 2 To lastRow            If Cells(i, "A").Value <> ticker Then                ticker = Cells(i, "A").Value                openPrice = Cells(i, "C").Value                                yearlyChange = 0                percentChange = 0                totalVolume = 0                                summaryRow = summaryRow + 1                                Range("I" & summaryRow).Value = ticker            End If                        closePrice = Cells(i, "F").Value                        yearlyChange = openPrice - closePrice            percentChange = yearlyChange / openPrice                        Range("J" & summaryRow).Value = yearlyChange            Range("K" & summaryRow).Value = percentChange            totalVolume = totalVolume + Cells(i, "G").Value            Range("L" & summaryRow).Value = totalVolume                        If percentChange > maxPercentIncrease Then                maxPercentIncrease = percentChange                maxPercentIncreaseTicker = ticker            End If                        If percentChange < maxPercentDecrease Then                maxPercentDecrease = percentChange                maxPercentDecreaseTicker = ticker            End If                        If totalVolume > maxTotalVolume Then                maxTotalVolume = totalVolume                maxTotalVolumeTicker = ticker            End If                        If i = lastRow Then                summaryRow = summaryRow + 1            End If        Next i                Range("P1").Value = "Ticker"        Range("Q1").Value = "Value"                Range("P2").Value = maxPercentIncreaseTicker        Range("Q2").Value = maxPercentIncrease                Range("P3").Value = maxPercentDecreaseTicker        Range("Q3").Value = maxPercentDecrease                Range("P4").Value = maxTotalVolumeTicker        Range("Q4").Value = maxTotalVolume                Range("J2:J" & summaryRow).FormatConditions.Add Type:=xlCellValue, Operator:=xlGreaterEqual, Formula1:="0"        Range("J2:J" & summaryRow).FormatConditions(Range("J2:J" & summaryRow).FormatConditions.Count).Interior.Color = RGB(0, 255, 0)        Range("J2:J" & summaryRow).FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, Formula1:="0"        Range("J2:J" & summaryRow).FormatConditions(Range("J2:J" & summaryRow).FormatConditions.Count).Interior.Color = RGB(255, 0, 0)        Next ws End Sub